<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <title>商品列表</title>
    {% load static %}
    <link type="text/css" href="{% static 'css/base.css' %}"  rel="stylesheet">
    <link type="text/css" href="{% static 'css/index.css' %}"  rel="stylesheet">
</head>
<body>
<div>
    <h2 align="center">商品列表</h2>
    <form role="search" action="{% url 'api:search_product' %}" method="get">
        {% csrf_token %}
        <div class="el-form-item el-form-item--small">
            <div class="el-form-item__content">
                <div class="el-input el-input--small">
                    <input style="width: 200px" autocomplete="off" class="el-input__inner" type="text" name="product_id" placeholder="请输入商品ID" >
                    <input style="width: 200px" autocomplete="off" class="el-input__inner" type="text" name="product_name" placeholder="请输入商品名称" >
                    <input class="el-button el-button--primary el-button--small" type="submit" value="搜索">
                    <input class="el-button el-button--primary el-button--small" type="reset" value="重置">
                </div>
            </div>
        </div>


    </form>
    <a class="el-button el-button--primary el-button--small" href="{% url 'api:add_product' %}">添加商品</a><br><br>
</div>
<div>
<table align="left">
<thead>
<tr>
    <th>商品ID</th>
    <th>商品名称</th>
    <th>商品价格</th>
    <th>商品描述</th>
    <th>新增时间</th>
    <th>操作</th>
</tr>
</thead>
{% if search_data_list %}
{% for search_data in search_data_list %}
    <tr>
            <td>{{ search_data.product_id }}</td>
            <td>{{ search_data.product_name }}</td>
            <td>{{ search_data.product_price }}</td>
            <td>{{ search_data.product_description }}</td>
            <td>{{ search_data.pub_date }}</td>
            <td>
                <a class="el-button el-button--default el-button--small" href="{% url 'api:product_details' search_data.id %}">商品详情</a>
                <a class="el-button el-button--default el-button--small" href="/api/edit_product/?product_id={{ p.product_id }}">编辑商品</a>
                <a class="el-button el-button--default el-button--small" href="/api/delete_product/?product_id={{ search_data.product_id }}">删除商品</a>

            </td>
        </tr>
{% endfor %}
{% endif %}
{% if response %}
        {% for p in response %}
        <tr>
            <td>{{ p.product_id }}</td>
            <td>{{ p.product_name }}</td>
            <td>{{ p.product_price }}</td>
            <td>{{ p.product_description }}</td>
            <td>{{ p.pub_date }}</td>
            <td>
                <a class="el-button el-button--default el-button--small" href="{% url 'api:product_details' p.id %}">商品详情</a>
                <a class="el-button el-button--default el-button--small" href="/api/edit_product/?product_id={{ p.product_id }}">编辑商品</a>
                <a class="el-button el-button--default el-button--small" href="/api/delete_product/?product_id={{ p.product_id }}">删除商品</a>

            </td>
        </tr>
    {% endfor %}
{% endif %}
</table>
{% if del_result %}
    <script language="javascript" type="text/javascript">
        alert('{{ del_result }}');
        {#两种重定向方式#}
        window.location.href = "{% url 'api:product_list' %}";
        {#setTimeout('location.href="{% url 'api:product_list' %}"', 3)#}
    </script>
{% endif %}
</div>
</body>
</html>